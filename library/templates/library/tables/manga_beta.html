<script>
    tabela_manga = $("#dash_dre_table").dxTreeList({
        dataSource: dados_tabela_mangas_manga,
        //treelist
        keyExpr: "id",
        parentIdExpr: "id_pai",
        autoExpandAll: false,
        //options default
        allowColumnReordering: optionsDefaultTables.allowColumnReordering,
        filterRow: optionsDefaultTables.filterRow,
        export: optionsDefaultTables.export,
        onFileSaving: optionsDefaultTables.onFileSaving,
        headerFilter: optionsDefaultTables.headerFilter,
        groupPanel: optionsDefaultTables.groupPanel,
        filterPanel: optionsDefaultTables.filterPanel,
        filterBuilderPopup: optionsDefaultTables.filterBuilderPopup,
        paging: optionsDefaultTables.paging,
        pager: optionsDefaultTables.pager,
        scrolling: optionsDefaultTables.scrolling,
        onEditorPreparing: function (e) {
            searchPanelCustomize(e);
            resetGroupToolbar(e);
            btnFilterAdvanced(e);
            btnClearFilter(e);
            btnGroupGeneric(e, [
                //arrayBtns example:
                // {
                //     btnClass: "btn btn-light",
                //     btnTooltip: "Título do Tooltip no Botão",
                //     btnClick: function(){
                //         //Ação do botão
                //     }
                // }
            ]);
            addBtnChooser(e);
            btnAfterEnd(e);
        },
        onContentReady: optionsDefaultTables.onContentReady,
        rowAlternationEnabled: optionsDefaultTables.rowAlternationEnabled,
        searchPanel: optionsDefaultTables.searchPanel,
        selection: optionsDefaultTables.selection,
        sorting: optionsDefaultTables.sorting,
        allowColumnResizing: optionsDefaultTables.allowColumnResizing,
        columnAutoWidth: optionsDefaultTables.columnAutoWidth,
        showColumnLines: optionsDefaultTables.showColumnLines,
        grouping: optionsDefaultTables.grouping,
        showRowLines: optionsDefaultTables.showRowLines,
        columnChooser: optionsDefaultTables.columnChooser,
        columnFixing: optionsDefaultTables.columnFixing,

        columns: [
            {
                //td1
                dataField: "desc_conta",
                caption: "Conta",
                dataType: "string",
                autoExpandAll: false,
                headerCellTemplate: function (container, options) {
                    filterRow(container, options);
                },
                cellTemplate: function (container, options) {
                    let dataFieldw = options.column.dataField.toString();
                    let htmlContent = "";
                    if (options.data.dre_indentacao === 1) {
                        if (options.data.tipo_conta_con === "A") {
                            htmlContent = `
                            <a href="javascript:dre_razao('${options.data.cd_conta_id}', '${options.data.desc_conta}',  ${options.data.anomes}, ${options.data.cd_centrocusto})">
                                <p class="font-weight-bold">${options.data.desc_conta}</p>
                            </a>
                    `;
                        } else {
                            htmlContent = `
                                <p class="font-weight-bold">${options.data.desc_conta}</p>
                    `;
                        }
                    }
                    if (options.data.dre_indentacao === 2) {
                        if (options.data.tipo_conta_con === "A") {
                            htmlContent = `
                            <a href="javascript:dre_razao('${options.data.cd_conta_id}', '${options.data.desc_conta}',  ${options.data.anomes}, ${options.data.cd_centrocusto})">
                                <u>${options.data.desc_conta}</u>
                            </a>
                    `;
                        } else {
                            htmlContent = `
                                <u>${options.data.desc_conta}</u>
                    `;
                        }
                    }
                    if (options.data.dre_indentacao === 3) {
                        if (options.data.tipo_conta_con === "A") {
                            htmlContent = `
                            <a href="javascript:dre_razao('${options.data.cd_conta_id}', '${options.data.desc_conta}',  ${options.data.anomes}, ${options.data.cd_centrocusto})">
                                ${options.data.desc_conta}
                            </a>
                    `;
                        } else {
                            htmlContent = `
                                <p>${options.data.desc_conta}</p>
                    `;
                        }
                    }
                    container.html(htmlContent).css('fontSize', '0.7rem');

                }
            },
            {
                caption: "Mês Atual",
                headerCellTemplate: function (container, options) {
                    container.parent().css('text-align', 'center');
                    container.html($(`<div class="font-weight-bold">${options.column.caption}</div>`)).css('fontSize', '0.8rem');
                },
                columns: [
                    {
                        //td2
                        dataField: "vlr_planejado",
                        caption: "Planejado",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },

                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = "R$ " + parseFloat(options.data[dataFieldw]).toLocaleFixed(2);
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td3
                        dataField: "av_perc_plan",
                        caption: "AV%",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td4
                        dataField: "vlr_realizado",
                        caption: "Realizado",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = "R$ " + parseFloat(options.data[dataFieldw]).toLocaleFixed(2);
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td5
                        dataField: "av_perc_real",
                        caption: "AV%",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    }]
            },
            {
                caption: "Mês Anterior",
                headerCellTemplate: function (container, options) {
                    container.parent().css('text-align', 'center');
                    container.html($(`<div class="font-weight-bold">${options.column.caption}</div>`)).css('fontSize', '0.8rem');
                },
                columns: [
                    {
                        //td6
                        dataField: "vlr_realizado_ma",
                        caption: "Realizado",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = "R$ " + parseFloat(options.data[dataFieldw]).toLocaleFixed(2);
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td7
                        dataField: "av_perc_ma",
                        caption: "AV%",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td8
                        dataField: "cres_perc_ma",
                        caption: "Cresc.",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    }]
            },
            {
                caption: "Ano Anterior",
                headerCellTemplate: function (container, options) {
                    container.parent().css('text-align', 'center');
                    container.html($(`<div class="font-weight-bold">${options.column.caption}</div>`)).css('fontSize', '0.8rem');

                },
                columns: [
                    {
                        //td9
                        dataField: "vlr_realizado_aa",
                        caption: "Realizado",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = "R$ " + parseFloat(options.data[dataFieldw]).toLocaleFixed(2);
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td10
                        dataField: "av_perc_aa",
                        caption: "AV%",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    },
                    {
                        //td11
                        dataField: "cres_perc_aa",
                        caption: "Cresc.",
                        dataType: "number",
                        headerCellTemplate: function (container, options) {
                            filterRow(container, options);
                        },
                        cellTemplate: function (container, options) {
                            let dataFieldw = options.column.dataField;
                            if (parseFloat(options.data[dataFieldw]).toString() === "NaN") {
                                dataFieldw = "--";
                            } else {
                                dataFieldw = parseFloat(options.data[dataFieldw]).toLocaleFixed(2) + "%";
                            }
                            let font_bold = "";
                            if (options.data.dre_indentacao === 1) {
                                font_bold = "font-weight-bold"
                            }
                            container.html(`
                                        <p class="${font_bold}">
                                            ${dataFieldw}
                                        </p>
                                        `).css('fontSize', '0.7rem');
                        }
                    }]
            }
        ]
    });
</script>